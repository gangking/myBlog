<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React简书项目 | MrXiong</title>
    <meta name="description" content="熊刚的个人博客首页，熊刚的技术作品，熊刚的生活成长">
    <link rel="icon" href="/myBlog/favicon.ico">
  <link rel="manifest" href="/myBlog/manifest.json">
    
    <link rel="preload" href="/myBlog/assets/css/0.styles.67215e50.css" as="style"><link rel="preload" href="/myBlog/assets/js/app.9a205e1a.js" as="script"><link rel="preload" href="/myBlog/assets/js/2.c03f67b8.js" as="script"><link rel="preload" href="/myBlog/assets/js/24.b5e770f4.js" as="script"><link rel="prefetch" href="/myBlog/assets/js/10.1772eaaa.js"><link rel="prefetch" href="/myBlog/assets/js/11.b72fb48b.js"><link rel="prefetch" href="/myBlog/assets/js/12.c2a1f8a6.js"><link rel="prefetch" href="/myBlog/assets/js/13.8288193b.js"><link rel="prefetch" href="/myBlog/assets/js/14.952ed0f9.js"><link rel="prefetch" href="/myBlog/assets/js/15.c67c2b45.js"><link rel="prefetch" href="/myBlog/assets/js/16.e7bdeb4f.js"><link rel="prefetch" href="/myBlog/assets/js/17.775b6b87.js"><link rel="prefetch" href="/myBlog/assets/js/18.3eb29a8e.js"><link rel="prefetch" href="/myBlog/assets/js/19.21de1f76.js"><link rel="prefetch" href="/myBlog/assets/js/20.94867820.js"><link rel="prefetch" href="/myBlog/assets/js/21.6daa352d.js"><link rel="prefetch" href="/myBlog/assets/js/22.5e365889.js"><link rel="prefetch" href="/myBlog/assets/js/23.b11b9f1d.js"><link rel="prefetch" href="/myBlog/assets/js/25.0d01a527.js"><link rel="prefetch" href="/myBlog/assets/js/26.cb940bf6.js"><link rel="prefetch" href="/myBlog/assets/js/27.ed621a85.js"><link rel="prefetch" href="/myBlog/assets/js/28.bcdc172f.js"><link rel="prefetch" href="/myBlog/assets/js/29.da4d0bf3.js"><link rel="prefetch" href="/myBlog/assets/js/3.0f742e16.js"><link rel="prefetch" href="/myBlog/assets/js/30.bbf7f9de.js"><link rel="prefetch" href="/myBlog/assets/js/31.f84eb563.js"><link rel="prefetch" href="/myBlog/assets/js/32.485bc394.js"><link rel="prefetch" href="/myBlog/assets/js/33.69f4ac61.js"><link rel="prefetch" href="/myBlog/assets/js/34.929ce270.js"><link rel="prefetch" href="/myBlog/assets/js/35.ecaae5f1.js"><link rel="prefetch" href="/myBlog/assets/js/36.fb388a85.js"><link rel="prefetch" href="/myBlog/assets/js/37.b0fc1645.js"><link rel="prefetch" href="/myBlog/assets/js/38.22c84c1e.js"><link rel="prefetch" href="/myBlog/assets/js/4.6c9ad4a3.js"><link rel="prefetch" href="/myBlog/assets/js/5.be02b664.js"><link rel="prefetch" href="/myBlog/assets/js/6.99df0c05.js"><link rel="prefetch" href="/myBlog/assets/js/7.872b75e5.js"><link rel="prefetch" href="/myBlog/assets/js/8.997b8e74.js"><link rel="prefetch" href="/myBlog/assets/js/9.3fefe930.js">
    <link rel="stylesheet" href="/myBlog/assets/css/0.styles.67215e50.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myBlog/" class="home-link router-link-active"><!----> <span class="site-name">MrXiong</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myBlog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端技术</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myBlog/webpack/" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/myBlog/react/" class="nav-link router-link-active">React</a></li><li class="dropdown-item"><!----> <a href="/myBlog/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/myBlog/es6/" class="nav-link">ES6</a></li></ul></div></div><div class="nav-item"><a href="/myBlog/node/" class="nav-link">后端及实用技术</a></div><div class="nav-item"><a href="/myBlog/social/" class="nav-link">社交媒体</a></div><div class="nav-item"><a href="/myBlog/about/" class="nav-link">生活与创作</a></div> <a href="https://github.com/gangking/myBlog" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/myBlog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端技术</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myBlog/webpack/" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/myBlog/react/" class="nav-link router-link-active">React</a></li><li class="dropdown-item"><!----> <a href="/myBlog/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/myBlog/es6/" class="nav-link">ES6</a></li></ul></div></div><div class="nav-item"><a href="/myBlog/node/" class="nav-link">后端及实用技术</a></div><div class="nav-item"><a href="/myBlog/social/" class="nav-link">社交媒体</a></div><div class="nav-item"><a href="/myBlog/about/" class="nav-link">生活与创作</a></div> <a href="https://github.com/gangking/myBlog" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>React开发</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myBlog/react/" class="sidebar-link">介绍</a></li><li><a href="/myBlog/react/01.html" class="sidebar-link">React基础</a></li><li><a href="/myBlog/react/02.html" class="sidebar-link">React慕课笔记</a></li><li><a href="/myBlog/react/03.html" class="active sidebar-link">简书项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#styled-components与reset-cs" class="sidebar-link">Styled-Components与Reset.cs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#基本配置" class="sidebar-link">基本配置</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#样式兼容插件" class="sidebar-link">样式兼容插件</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#header" class="sidebar-link">Header</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#logo" class="sidebar-link">logo</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#导航栏" class="sidebar-link">导航栏</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#右侧浮动按钮" class="sidebar-link">右侧浮动按钮</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#使用iconfont嵌入图标" class="sidebar-link">使用iconfont嵌入图标</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#搜索框样式" class="sidebar-link">搜索框样式</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#数据优化（重点）" class="sidebar-link">数据优化（重点）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#react-redux进行应用数据管理" class="sidebar-link">React-Redux进行应用数据管理</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#combinereducers完成对数据的拆分管理" class="sidebar-link">combineReducers完成对数据的拆分管理</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#使用immutable-js来管理store中的数据" class="sidebar-link">使用Immutable.js来管理store中的数据</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#使用redux-immutable统一数据格式" class="sidebar-link">使用redux-immutable统一数据格式</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#样式编码" class="sidebar-link">样式编码</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#header代码优化" class="sidebar-link">header代码优化</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#ajax获取推荐数据" class="sidebar-link">Ajax获取推荐数据</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#代码优化微调" class="sidebar-link">代码优化微调</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#热门搜索换一批" class="sidebar-link">热门搜索换一批</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#默认显示10个" class="sidebar-link">默认显示10个</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#热门搜索显示与隐藏" class="sidebar-link">热门搜索显示与隐藏</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#换一批" class="sidebar-link">换一批</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#key报错" class="sidebar-link">key报错</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#immutable的merage方法" class="sidebar-link">immutable的merage方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#规避无意义的ajax请求" class="sidebar-link">规避无意义的Ajax请求</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#路由" class="sidebar-link">路由</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#概念" class="sidebar-link">概念</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#首页拆分" class="sidebar-link">首页拆分</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#首页专题" class="sidebar-link">首页专题</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#首页文章列表" class="sidebar-link">首页文章列表</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#首页推荐部分" class="sidebar-link">首页推荐部分</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#首页数据接口定义" class="sidebar-link">首页数据接口定义</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#代码拆分" class="sidebar-link">代码拆分</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#加载更多" class="sidebar-link">加载更多</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#返回顶部" class="sidebar-link">返回顶部</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#代码优化" class="sidebar-link">代码优化</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#首页性能优化及路由跳转" class="sidebar-link">首页性能优化及路由跳转</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#性能优化" class="sidebar-link">性能优化</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#路由跳转" class="sidebar-link">路由跳转</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#详情页" class="sidebar-link">详情页</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#数据管理" class="sidebar-link">数据管理</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#页面路由参数传递" class="sidebar-link">页面路由参数传递</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#登录校验" class="sidebar-link">登录校验</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#布局" class="sidebar-link">布局</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#功能实现" class="sidebar-link">功能实现</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#登录鉴权及代码优化" class="sidebar-link">登录鉴权及代码优化</a></li></ul></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#异步组件及路由使用" class="sidebar-link">异步组件及路由使用</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#项目上线" class="sidebar-link">项目上线</a></li><li class="sidebar-sub-header"><a href="/myBlog/react/03.html#react版本升级说明" class="sidebar-link">React版本升级说明</a></li></ul></li><li><a href="/myBlog/react/04.html" class="sidebar-link">项目心得</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react简书项目"><a href="#react简书项目" aria-hidden="true" class="header-anchor">#</a> React简书项目</h1> <p><a href="https://www.jianshu.com/" target="_blank" rel="noopener noreferrer">按照简书官网去做一个React项目<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://github.com/gangking/jianshu" target="_blank" rel="noopener noreferrer">项目源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="styled-components与reset-cs"><a href="#styled-components与reset-cs" aria-hidden="true" class="header-anchor">#</a> Styled-Components与Reset.cs</h2> <ul><li>css文件一旦在一个文件中引用之后，在其他组件中都生效</li> <li>所以为了避免样式冲突一般，采用第三方模块插件对样式文件进行管理</li></ul> <p>安装：</p> <div class="language- extra-class"><pre class="language-text"><code>npm i styled-components -S
</code></pre></div><h3 id="基本配置"><a href="#基本配置" aria-hidden="true" class="header-anchor">#</a> 基本配置</h3> <div class="language- extra-class"><pre class="language-text"><code>index.js
去掉index.css文件引入style.js文件
import { createGlobalStyle } from 'styled-component';

createGlobalStyle`
    body {
        margin: 0;
        padding: 0;
        font-family: sans-serif;
        background: green;
    }
`

injectGlobal- 全局样式（已弃用）
改成：createGlobalStyle(推荐)
用法是
	1、利用createGlobalStyle导出一个样式对象；
export const GlobalstyleIcon = createGlobalStyle`
	...书写样式
`;
	2、在主容器组件App.js中以标签组件的形式引入即可
import { Globalstyle } from './style';
import { GlobalstyleIcon } from './statics/iconfont/iconfont.js';

render () {
    return (
      &lt;div&gt;
        &lt;Globalstyle&gt;&lt;/Globalstyle&gt;
        &lt;GlobalstyleIcon&gt;&lt;/GlobalstyleIcon&gt;
        &lt;Header&gt;&lt;/Header&gt;
      &lt;/div&gt;
    );
  }
</code></pre></div><h3 id="样式兼容插件"><a href="#样式兼容插件" aria-hidden="true" class="header-anchor">#</a> 样式兼容插件</h3> <p>​	网页版的简书，需要在不同的浏览器样式保持一致，所以还需要一个新的第三方插件：</p> <p>Reset CSS:<a href="https://meyerweb.com/eric/tools/css/reset/" target="_blank" rel="noopener noreferrer">https://meyerweb.com/eric/tools/css/reset/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>用法：</p> <p>​	复制全局样式至createGlobalStyle即可。</p> <p>主要是消除在不同浏览器上的默认样式。</p> <h2 id="header"><a href="#header" aria-hidden="true" class="header-anchor">#</a> Header</h2> <p>&amp;.指同级样式</p> <p>基本布局：</p> <div class="language- extra-class"><pre class="language-text"><code>- common
-- header
+++ Header.js
+++ style.js

1、在style.js中引入styled-compnents
import styled from 'styled-components';

export const HeaderWrapper = styled.div`
    height: 56px;
    background: red;
`;
相当于新建 HeaderWrapper 标签；

2、在Header.js中引入即可
import React from 'react';
import { HeaderWrapper } from './style'

class Header extends React.Component {
  render () {
    return (
      &lt;HeaderWrapper&gt;header&lt;/HeaderWrapper&gt;
    )
  }
}

export default Header;
</code></pre></div><h3 id="logo"><a href="#logo" aria-hidden="true" class="header-anchor">#</a> logo</h3> <div class="language- extra-class"><pre class="language-text"><code>import logPic from '../../statics/logo.png'

export const Logo = styled.a.attrs({
  href: '/'
})`
    position:absolute;
    top: 0;
    left: 0;
    width: 100px;
    height: 58px; 
    background: url(${logPic});
    background-size: contain;
`;
注意：
	图片地址的引用；
	href属性还可以在标签中直接设置；
</code></pre></div><h3 id="导航栏"><a href="#导航栏" aria-hidden="true" class="header-anchor">#</a> 导航栏</h3> <div class="language- extra-class"><pre class="language-text"><code>export const Nav = styled.div`
    width: 960px;
    height: 100%;
    padding-rgiht: 70px;
    box-sizing: border-box;
    margin: 0 auto;
    background: green;
`

导航栏中的元素样式
export const NavItem = styled.div`
    line-height: 56px;
    padding: 0 15px;
    font-size: 17px;
    color: #333;
    &amp;.left {
      float: left;
    }
    &amp;.right {
      float: right;
      color: #969696;
    }
    &amp;.active{
      color: #ea6f5a;
    }
`;
元素页面引用：
&lt;NavItem className='left active'&gt;首页&lt;/NavItem&gt;
&lt;NavItem className='left'&gt;下载APP&lt;/NavItem&gt;
&lt;NavItem className='right'&gt;登录&lt;/NavItem&gt;
&lt;NavItem className='right'&gt;Aa&lt;/NavItem&gt;

查询输入框样式：
export const NavSearch = styled.input.attrs({
  placeholder: '搜索'
})`
    width: 160px;
    height: 38px;
    border: 1px solid #ccc;
    outline: none;
    border-radius: 19px;
    background: #eee;
    margin-top: 9px;
    padding: 0 20px;
    box-sizing: border-box;
    font-size: 14px;
    margin-left: 20px;
    &amp;::placeholder {
      color: #999;
    }
`;
</code></pre></div><h3 id="右侧浮动按钮"><a href="#右侧浮动按钮" aria-hidden="true" class="header-anchor">#</a> 右侧浮动按钮</h3> <div class="language- extra-class"><pre class="language-text"><code>&lt;Addition&gt;
    &lt;Button className='waitting'&gt;写文章&lt;/Button&gt;
    &lt;Button className='reg'&gt;注册&lt;/Button&gt;
&lt;/Addition&gt;

export const Addition = styled.div`
      position: absolute;
      right:0;
      top:0;
      height:56px;
`;

export const Button = styled.div`
      float:right;
      line-height:38px;
      border-radius:19px;
      margin-top:9px;
      border:1px solid #ec6149;
      margin-right: 20px;
      padding: 0 20px;
      font-size: 14px;
      &amp;.reg{
        color:#ec6149;
      }
      &amp;.waitting{
        color: #fff;
        background: #ec6149;
      }
`;
</code></pre></div><h3 id="使用iconfont嵌入图标"><a href="#使用iconfont嵌入图标" aria-hidden="true" class="header-anchor">#</a> 使用iconfont嵌入图标</h3> <p><a href="https://www.iconfont.cn/" target="_blank" rel="noopener noreferrer">阿里图标<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="搜索框样式"><a href="#搜索框样式" aria-hidden="true" class="header-anchor">#</a> 搜索框样式</h3> <h4 id="基本样式"><a href="#基本样式" aria-hidden="true" class="header-anchor">#</a> 基本样式</h4> <div class="language- extra-class"><pre class="language-text"><code>export const SearchWrapper = styled.div`
    float: left;
    position: relative;
    .iconfont{
      position:absolute;
      right:5px;
      bottom:5px;
      width: 30px;
      height: 30px;
      border-radius: 15px;
      line-height: 30px;
      text-align: center;
    }
`;

&lt;SearchWrapper&gt;
      &lt;NavSearch /&gt;
      &lt;span className=&quot;iconfont&quot;&gt;&amp;#xe637;&lt;/span&gt;
&lt;/SearchWrapper&gt;
</code></pre></div><h4 id="动画效果"><a href="#动画效果" aria-hidden="true" class="header-anchor">#</a> 动画效果</h4> <p>数据变，react跟着变</p> <h4 id="获取焦点和失去焦点样式"><a href="#获取焦点和失去焦点样式" aria-hidden="true" class="header-anchor">#</a> 获取焦点和失去焦点样式</h4> <div class="language- extra-class"><pre class="language-text"><code>搜索框长度变化：
export const NavSearch = styled.input.attrs({
  placeholder: '搜索'
})`
    width: 160px;
    height: 38px;
    border: 1px solid #ccc;
    outline: none;
    border-radius: 19px;
    background: #eee;
    margin-top: 9px;
    padding: 0 30px 0 20px;
    box-sizing: border-box;
    font-size: 14px;
    margin-left: 20px;
    color: #666;
    &amp;::placeholder {
      color: #999;
    }

    &amp;.focused {
      width: 250px;
    }
`;
图标背景色：
export const SearchWrapper = styled.div`
    float: left;
    position: relative;
    .iconfont{
      position:absolute;
      right:5px;
      bottom:5px;
      width: 30px;
      height: 30px;
      border-radius: 15px;
      line-height: 30px;
      text-align: center;
      &amp;.focused {
        background: #777;
        color: white;
      }
    }
`;

页面设置：
&lt;SearchWrapper&gt;
    &lt;NavSearch
        className={this.state.focused ? 'focused' : ''}
        onFocus={this.handleInputFocus}
        onBlur={this.handleInputBlur}
    /&gt;
    &lt;span
        className={this.state.focused ? 'focused iconfont' : 'iconfont'}
    &gt;&amp;#xe637;&lt;/span&gt;
&lt;/SearchWrapper&gt;
</code></pre></div><h4 id="实现动画过渡"><a href="#实现动画过渡" aria-hidden="true" class="header-anchor">#</a> 实现动画过渡</h4> <div class="language- extra-class"><pre class="language-text"><code>安装
npm i react-transition-group - S

引入：
import { CSSTransition } from 'react-transition-group';

&lt;CSSTransition
     timeout={200}
     in={this.state.focused}
     classNames='slide'
&gt;
     &lt;NavSearch
        className={this.state.focused ? 'focused' : ''}
        onFocus={this.handleInputFocus}
        onBlur={this.handleInputBlur}
      /&gt;
&lt;/CSSTransition&gt;

样式放在SearchWrapper下面
.slide-enter {
      transition: all .2s ease-out
}

.slide-enter-active{
      width: 250px;
}

.slide-exit {
      transition: all .2s ease-out
}

slide-exit-active{
      width: 160px;
}
推荐放在NavSearch中，前面追加&amp;.
表示同级元素
</code></pre></div><h2 id="数据优化（重点）"><a href="#数据优化（重点）" aria-hidden="true" class="header-anchor">#</a> 数据优化（重点）</h2> <h3 id="react-redux进行应用数据管理"><a href="#react-redux进行应用数据管理" aria-hidden="true" class="header-anchor">#</a> React-Redux进行应用数据管理</h3> <p>安装</p> <div class="language- extra-class"><pre class="language-text"><code>npm i react-redux -S
npm i redux -S

- store
++ index.js
++ reducer.js

App.js
import store from './store';
import { Provider } from 'react-redux';

&lt;Provider store={store}&gt;
   &lt;Header&gt;&lt;/Header&gt;
&lt;/Provider&gt;

- common
-- header
--- index.js
// 将store中所有数据映射到props
const mapStateToProps = (state) =&gt; {
  return {
    focused: state.focused
  }
}

// store.dispatch 挂载到 props上
const mapDispathToProps = (dispatch) =&gt; {
  return {
  }
}
export default connect(mapStateToProps, mapDispathToProps)(Header);
同时就可以去掉 this.state了,改成this.props
</code></pre></div><h4 id="绑定事件"><a href="#绑定事件" aria-hidden="true" class="header-anchor">#</a> 绑定事件</h4> <div class="language- extra-class"><pre class="language-text"><code>// store.dispatch 挂载到 props上
const mapDispathToProps = (dispatch) =&gt; {
  return {
    handleInputFocus (e) {
      const action = {
        type: 'search_focus'
      }
      dispatch(action)
    },
    handleInputBlur (e) {
      const action = {
        type: 'search_blur'
      }
      dispatch(action)
    }
  }
}

reducer.js
export default (state = defaultState, action) =&gt; {
  if (action.type === 'search_focus') {
    const newState = JSON.parse(JSON.stringify(state));
    newState.focused = true;
    return newState
  } else if (action.type === 'search_blur') {
    const newState = JSON.parse(JSON.stringify(state));
    newState.focused = false;
    return newState
  }
  return state;
}

可以改成无状态组件了
</code></pre></div><h3 id="combinereducers完成对数据的拆分管理"><a href="#combinereducers完成对数据的拆分管理" aria-hidden="true" class="header-anchor">#</a> combineReducers完成对数据的拆分管理</h3> <p>​	当前对于数据的存储以及数据的处理都放在reducer.js中处理，这样如果要存储和处理的数据量非常大的话，那么这个文件代码量也是非常大的。</p> <p>1、redux-devtools工具使用</p> <p><a href="https://github.com/zalmoxisus/redux-devtools-extension#usage" target="_blank" rel="noopener noreferrer">redux-devtools-extension<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- extra-class"><pre class="language-text"><code>const store = createStore(
  reducer,
  window.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; window.__REDUX_DEVTOOLS_EXTENSION__()
);

改进：
import { createStore, applyMiddleware, compose } from 'redux';
import reducer from './reducer';

const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}) : compose;

const enhancer = composeEnhancers(
  // 导入其他插件
  // applyMiddleware(thunk),
);

const store = createStore(reducer, enhancer);

export default store;
</code></pre></div><p>2、拆分reducer.js</p> <p>​	例如，header数据相关的就在header下面专门放一个store进行管理。</p> <div class="language- extra-class"><pre class="language-text"><code>- common
-- header
--- store
++ reducer.js
将src - store - reducer.js中内容全部复制过来
同时
src - store - reducer.js：
import { combineReducers } from 'redux';
import { reducer as headerReducer } from '../common/header/store/';

const reducer = combineReducers({
  header: headerReducer
})

export default reducer;
注意：
	1、combineReducers 用来生成一个新的reducer
	
优化路径：
	1、在header的store文件夹中新建index.js
import reducer from './reducer';

export { reducer }

这样可以简化下路径；
</code></pre></div><h4 id="actioncreators与constants的拆分"><a href="#actioncreators与constants的拆分" aria-hidden="true" class="header-anchor">#</a> actionCreators与constants的拆分</h4> <h5 id="actioncreators"><a href="#actioncreators" aria-hidden="true" class="header-anchor">#</a> actionCreators</h5> <div class="language- extra-class"><pre class="language-text"><code>- header
-- store
++ actionCreators.js
export const searchFocus = () =&gt; ({
  type: 'search_focus'
})

export const searchBlur = () =&gt; ({
  type: 'search_blur'
})

- header
-- index.js
import * as actionCreators from './store/actionCreators';

const mapDispathToProps = (dispatch) =&gt; {
  return {
    handleInputFocus (e) {
+      dispatch(actionCreators.searchFocus())
    },
    handleInputBlur (e) {
+      dispatch(actionCreators.searchBlur())
    }
  }
}
</code></pre></div><h5 id="constants"><a href="#constants" aria-hidden="true" class="header-anchor">#</a> constants</h5> <p>​	进一步拆分actionCreators</p> <div class="language- extra-class"><pre class="language-text"><code>- header
-- store
++ constants.js

export const SEARCH_FOCUS = 'header/SEARCH_FOCUS';
export const SEARCH_BLUR = 'header/SEARCH_BLUR';

actionCreators.js

import * as constans from './constants'
export const searchFocus = () =&gt; ({
  type: constans.SEARCH_FOCUS
})

export const searchBlur = () =&gt; ({
  type: constans.SEARCH_BLUR
})

reducer.js

import * as constans from './constants'

if (action.type === constans.SEARCH_FOCUS) {
    const newState = JSON.parse(JSON.stringify(state));
    newState.focused = true;
    return newState
  } else if (action.type === constans.SEARCH_BLUR) {
    const newState = JSON.parse(JSON.stringify(state));
    newState.focused = false;
    return newState
  }
</code></pre></div><p>store文件夹下 通过 index.js将所有文件导出去</p> <div class="language- extra-class"><pre class="language-text"><code>import reducer from './reducer';
import * as actionCreators from './actionCreators';
import * as constants from './constants';

export { reducer, actionCreators, constants }

header-index.js

如果要用actionCreators，则：
import { actionCreators } from './store';
</code></pre></div><h3 id="使用immutable-js来管理store中的数据"><a href="#使用immutable-js来管理store中的数据" aria-hidden="true" class="header-anchor">#</a> 使用Immutable.js来管理store中的数据</h3> <ul><li><p>reducer.js中state只能读取，不能修改。</p></li> <li><p>对于新手容易忘记这个问题</p></li></ul> <p>所以facebook团队历时三年开发了：</p> <ol><li>Immutable.js</li> <li>生成Immutable对象（不可改变的对象）</li> <li>所以将state变成Immutable对象</li></ol> <p><a href="https://github.com/immutable-js/immutable-js" target="_blank" rel="noopener noreferrer">官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- extra-class"><pre class="language-text"><code>npm install immutable -S

reducer.js
import { fromJS } from 'immutable';

const defaultState = fromJS({
  focused: false
});

export default (state = defaultState, action) =&gt; {
  if (action.type === constans.SEARCH_FOCUS) {
    // immutable对象的set会结合之前immutable对象的值
    // 和设置的值，返回一个全新的对象
    return state.set('focused', true);
  } else if (action.type === constans.SEARCH_BLUR) {
    return state.set('focused', false);
  }
  return state;
}

注意：
	1、immutable对象的set会结合之前immutable对象的值和设置的值，返回一个全新的对象
	2、defaultState必须用fromJS函数转换
	
header index.js
// 将store中所有数据映射到props
const mapStateToProps = (state) =&gt; {
  return {
    focused: state.header.get('focused')
  }
}

注意： 
	取值必须通过.get()形式
</code></pre></div><h3 id="使用redux-immutable统一数据格式"><a href="#使用redux-immutable统一数据格式" aria-hidden="true" class="header-anchor">#</a> 使用redux-immutable统一数据格式</h3> <p>例如：</p> <div class="language- extra-class"><pre class="language-text"><code>// 将store中所有数据映射到props
const mapStateToProps = (state) =&gt; {
  return {
    focused: state.header.get('focused')
  }
}

获取focused方式是不统一的；
前面是属性的方式，后面跟方法；

最好统一！（即，state也是immutable对象）
</code></pre></div><p>安装第三方插件：redux-immutable</p> <div class="language- extra-class"><pre class="language-text"><code>npm i redux-immutable -S


- src
-- store
-- reducer.js
将：import { combineReducers } from 'redux';
改为：import { combineReducers } from 'redux-immutable';
redux-immutable中有同样的方法


- header
-- index.js
// 将store中所有数据映射到props
const mapStateToProps = (state) =&gt; {
  return {
    focused: state.get('header').get('focused')
  }
}

换个写法：
focused: state.getIn(['header','focused'])
</code></pre></div><p><a href="https://immutable-js.github.io/immutable-js/" target="_blank" rel="noopener noreferrer">immutable官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：需要翻墙</p> <p><a href="https://immutable-js.github.io/immutable-js/docs/#/fromJS" target="_blank" rel="noopener noreferrer">fromJs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>##热门搜索布局</p> <h3 id="样式编码"><a href="#样式编码" aria-hidden="true" class="header-anchor">#</a> 样式编码</h3> <p>页面定义一个函数</p> <div class="language- extra-class"><pre class="language-text"><code>页面代码部分：
// 热门搜索方法
const getListArea = (show) =&gt; {
  if (show) {
    return (
      &lt;SearchInfo&gt;
        &lt;SearchInfoTitle&gt;
          热门搜索
              &lt;SearchInfoSwitch&gt;换一批&lt;/SearchInfoSwitch&gt;
        &lt;/SearchInfoTitle&gt;
        &lt;SearchInfoList&gt;
          &lt;SearchInfoItem&gt;区块链&lt;/SearchInfoItem&gt;
          &lt;SearchInfoItem&gt;小程序&lt;/SearchInfoItem&gt;
          &lt;SearchInfoItem&gt;Vue&lt;/SearchInfoItem&gt;
          &lt;SearchInfoItem&gt;毕业&lt;/SearchInfoItem&gt;
          &lt;SearchInfoItem&gt;PHP&lt;/SearchInfoItem&gt;
          &lt;SearchInfoItem&gt;故事&lt;/SearchInfoItem&gt;
          &lt;SearchInfoItem&gt;理财&lt;/SearchInfoItem&gt;
          &lt;SearchInfoItem&gt;美食&lt;/SearchInfoItem&gt;
          &lt;SearchInfoItem&gt;投稿&lt;/SearchInfoItem&gt;
        &lt;/SearchInfoList&gt;
      &lt;/SearchInfo&gt;
    );
  } else {
    return null;
  }
}
样式代码部分：
export const SearchInfo = styled.div`
      position: absolute;
      left: 0;
      top: 56px;
      width: 240px;
      padding: 0 20px;
      box-shadow: 0 0 8px rgba(0,0,0,.2);
`;

export const SearchInfoTitle = styled.div`
      margin-top: 20px;
      margin-bottom: 15px;
      line-height: 20px;
      font-size: 13px;
      color: #969696;
`;

export const SearchInfoSwitch = styled.div`
      float: right;
      font-size: 13px;
`;

export const SearchInfoList = styled.div`
      overflow: hidden;
      width: 200px;
`;

export const SearchInfoItem = styled.a`
      float: left;
      font-size: 12px;
      line-height: 20px;
      padding: 0 5px;
      border: 1px solid #ddd;
      color: #787878;
      border-radius: 3px;
      display: bloack;
      margin-right: 10px;
      margin-bottom: 15px;
      cursor: pointer;
      &amp;:hover{
        background: #787878;
        color: white;
      }
`;
</code></pre></div><p>再将函数在搜索框调用，并传入focused</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;SearchWrapper&gt;
	......
    {getListArea(focused)}
&lt;/SearchWrapper&gt;
</code></pre></div><h3 id="header代码优化"><a href="#header代码优化" aria-hidden="true" class="header-anchor">#</a> header代码优化</h3> <p>​	因为当前header无状态组件内容很多，依然不便管理，所以需要继续改成普通UI组件。</p> <h3 id="ajax获取推荐数据"><a href="#ajax获取推荐数据" aria-hidden="true" class="header-anchor">#</a> Ajax获取推荐数据</h3> <div class="language- extra-class"><pre class="language-text"><code>安装：
npm i axios -S
yarn add redux-thunk
</code></pre></div><h4 id="基本配置-2"><a href="#基本配置-2" aria-hidden="true" class="header-anchor">#</a> 基本配置</h4> <div class="language- extra-class"><pre class="language-text"><code>- src 
-- store
-- index.js
+ import thunk from 'redux-thunk';
+ applyMiddleware(thunk),

- header
-- index.js
// store.dispatch 挂载到 props上
const mapDispathToProps = (dispatch) =&gt; {
  return {
    handleInputFocus (e) {
+     dispatch(actionCreators.getList())
      dispatch(actionCreators.searchFocus())
    },
    handleInputBlur (e) {
      dispatch(actionCreators.searchBlur())
    }
  }
}

配置 action 类型和 方法
- header
-- store

constants.js
export const CHANGE_LIST = 'header/CHANGE_LIST';

actionCreators.js
export const changeList = (data) =&gt; ({
  type: constans.CHANGE_LIST,
  data: fromJS(data)
})

const api = 'https://www.easy-mock.com/mock/5cac669516fea85e587f8deb/luodiye';
export const getList = () =&gt; {
  return (dispatch) =&gt; {
    axios.get(api + '/trending_search').then((res) =&gt; {
      console.log(res.data.data);
      const data = res.data.data;
      dispatch(changeList(data));
    }).catch(() =&gt; {
      alert('调接口失败！')
    })
  }
}
注意：
	1、因为应用了 redux-thunk,所以getList可以为一个函数
	2、发送changeList指令传过去的必须也是immutable对象，所以需要用fromJs转化一下。
	
reducer.js
else if (action.type === constans.CHANGE_LIST) {
    // set方法将list本来imutable对象数组转换成了普通list数组
    // 这样会有问题,所以要将传过来的action提前转成imutable对象
    return state.set('list', action.data);
}
</code></pre></div><h4 id="页面引用"><a href="#页面引用" aria-hidden="true" class="header-anchor">#</a> 页面引用</h4> <div class="language- extra-class"><pre class="language-text"><code>1、首先挂载list数据
// 将store中所有数据映射到props
const mapStateToProps = (state) =&gt; {
  return {
    focused: state.getIn(['header', 'focused']),
    list: state.getIn(['header', 'list'])
  }
}

2、页面循环生成DOM
&lt;SearchInfoList&gt;
 {
    this.props.list.map((item) =&gt; {
     return &lt;SearchInfoItem key={item}&gt;{item}&lt;/SearchInfoItem&gt;
    })
  }
&lt;/SearchInfoList&gt;
</code></pre></div><h3 id="代码优化微调"><a href="#代码优化微调" aria-hidden="true" class="header-anchor">#</a> 代码优化微调</h3> <ol><li><p>在actionCreators.js中有一些不用导出的action指令方法，去掉export,并放在顶部。</p></li> <li><p>循环生成热门搜索标签时，可以将props解构出来。</p></li> <li><p>render()方法中同上；</p></li> <li><p>reducer.js中大量使用了if else语句，可以改成switch语句；</p> <div class="language- extra-class"><pre class="language-text"><code>switch (action.type) {
    case constans.SEARCH_FOCUS:
      return state.set('focused', true);
    case constans.SEARCH_BLUR:
      return state.set('focused', false);
    case constans.CHANGE_LIST:
      return state.set('list', action.data);
}
因为已经 return 了，所以不用 breack了。
</code></pre></div></li></ol> <h2 id="热门搜索换一批"><a href="#热门搜索换一批" aria-hidden="true" class="header-anchor">#</a> 热门搜索换一批</h2> <h3 id="默认显示10个"><a href="#默认显示10个" aria-hidden="true" class="header-anchor">#</a> 默认显示10个</h3> <div class="language- extra-class"><pre class="language-text"><code>1、定义页码和页数
reducer.js
const defaultState = fromJS({
  focused: false,
  list: [],
+  page: 1,
+  totalPage: 1
});

2、action指令要发送最新页数
actionCreators.js
const changeList = (data) =&gt; ({
  type: constans.CHANGE_LIST,
  data: fromJS(data),
  totalPage: fromJS(data.length / 10)
})

3、更新list同时更新totalPage
return state.set('list', action.data).set('totalPage', action.totalPage);
</code></pre></div><h3 id="热门搜索显示与隐藏"><a href="#热门搜索显示与隐藏" aria-hidden="true" class="header-anchor">#</a> 热门搜索显示与隐藏</h3> <ul><li><p>当失去焦点，但不是在热门搜索中点击时，隐藏热门搜索</p></li> <li><p>当鼠标移入热门搜索区域时，再失去焦点，不能隐藏热门搜索</p></li> <li><p>第二点之后，如果此时鼠标移出热门搜索区域，要隐藏热门搜索了</p></li></ul> <p>即，</p> <ol><li><p>定义一个mouseIn变量</p> <div class="language- extra-class"><pre class="language-text"><code>const defaultState = fromJS({
  focused: false,
+  mouseIn: false,
  list: [],
  page: 1,
  totalPage: 1
});
</code></pre></div></li> <li><p>给热门搜索区域定义移入移除事件，改变mouseIn</p> <div class="language- extra-class"><pre class="language-text"><code>+ if (focused || mouseIn) {
      return (
        &lt;SearchInfo
+          onMouseEnter={handleMouseEnter}
+          onMouseLeave={handleMouseLeave}
        &gt;
          &lt;SearchInfoTitle&gt;
            热门搜索
                &lt;SearchInfoSwitch&gt;换一批&lt;/SearchInfoSwitch&gt;
          &lt;/SearchInfoTitle&gt;
          &lt;SearchInfoList&gt;
            {pageList}
          &lt;/SearchInfoList&gt;
        &lt;/SearchInfo&gt;
      );
    } else {
      return null;
    }
</code></pre></div></li> <li><p>用mouseIn联合focused控制热门搜索区域的显示隐藏</p> <div class="language- extra-class"><pre class="language-text"><code>if (focused || mouseIn){}
</code></pre></div></li></ol> <h3 id="换一批"><a href="#换一批" aria-hidden="true" class="header-anchor">#</a> 换一批</h3> <p>1、注册点击事件，并传递当前页和总页数</p> <p>2、判断：当前页小于总页数则加1，等于总页数则置1；</p> <p>注意：</p> <ul><li>循环生成选项时，要判断是否有值存在小数情况）</li> <li>当给reducer传总页数时，记得取整向下取整（即，+1）；</li></ul> <h3 id="key报错"><a href="#key报错" aria-hidden="true" class="header-anchor">#</a> key报错</h3> <p>​	当经过immutable转换成普通数组之后，渲染页面，明明已经加了key值，依然会有错误提示？</p> <p>原因：</p> <ol><li>list的初始值为1，在为请求ajax之前，就进入了循环</li></ol> <p>解决方法：</p> <p>用 if(newList){} 将循环包裹起来</p> <h3 id="immutable的merage方法"><a href="#immutable的merage方法" aria-hidden="true" class="header-anchor">#</a> immutable的merage方法</h3> <p>同时设置多个值</p> <div class="language- extra-class"><pre class="language-text"><code>return state.merge({
        list: action.data,
        totalPage: action.totalPage
      })
// return state.set('list', action.data).set('totalPage', action.totalPage);
    
</code></pre></div><ul><li><p>相对于多次调用set，但是性能更高，默认只会调用一次。</p></li> <li><p>而set调用两次，会返回两个immutable数据类型。</p></li></ul> <h2 id="规避无意义的ajax请求"><a href="#规避无意义的ajax请求" aria-hidden="true" class="header-anchor">#</a> 规避无意义的Ajax请求</h2> <p>点击输入框只需要请求一次即可。</p> <p>即，</p> <ul><li><p>搜索框获取焦点时，给事件传递list参数；</p></li> <li><p>当list.size为0时才调用接口请求数据</p></li></ul> <p>注意：带参数传值要用es6语法</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;NavSearch
   className={focused ? 'focused' : ''}
   onFocus={() =&gt; { handleInputFocus(list) }}
   onBlur={handleInputBlur}
/&gt;


if (list.size === 0) {
    dispatch(actionCreators.getList())
}

优化：(list.size === 0) &amp;&amp; dispatch(actionCreators.getList());
</code></pre></div><h2 id="路由"><a href="#路由" aria-hidden="true" class="header-anchor">#</a> 路由</h2> <h3 id="概念"><a href="#概念" aria-hidden="true" class="header-anchor">#</a> 概念</h3> <p>​	根据url的不同显示不同的内容。</p> <p>安装：</p> <div class="language- extra-class"><pre class="language-text"><code>npm i react-router-dom -S

App.js
引入：
import { BrowserRouter as Router, Route } from 'react-router-dom';

使用：
Router&gt;
   &lt;Route path='/' exact render={() =&gt; &lt;div&gt;home&lt;/div&gt;}&gt;&lt;/Route&gt;
   &lt;Route path='/detail' exact render={() =&gt; &lt;div&gt;detail&lt;/div&gt;}&gt;&lt;/Route&gt;
&lt;/Router&gt;

exact ： 精准匹配
</code></pre></div><h2 id="首页拆分"><a href="#首页拆分" aria-hidden="true" class="header-anchor">#</a> 首页拆分</h2> <p>首先创建首页和详情页的结构</p> <div class="language- extra-class"><pre class="language-text"><code>- src
++ page
-- page
+++ datail
++++ index.js
+++ home
++++ index.js
</code></pre></div><p>首页包含两大块：</p> <ul><li><p>HomWrapperLeft</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;HomWrapperLeft&gt;
     &lt;img className='banner-img' src='url' /&gt;
     &lt;Topic&gt;Topic&lt;/Topic&gt;
     &lt;List&gt;List&lt;/List&gt;
&lt;/HomWrapperLeft&gt;
</code></pre></div></li> <li><p>HomWrapperRight</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;HomWrapperRight&gt;
  &lt;Recommend&gt;Recommend&lt;/Recommend&gt;
  &lt;Writer&gt;Writer&lt;/Writer&gt;
&lt;/HomWrapperRight&gt;
</code></pre></div></li></ul> <p>根据这两块拆分组件</p> <div class="language- extra-class"><pre class="language-text"><code>- home 
++ components
+++ Recommend.js
+++ List.js
+++ Topic.js
+++ Writer.js
</code></pre></div><h3 id="首页专题"><a href="#首页专题" aria-hidden="true" class="header-anchor">#</a> 首页专题</h3> <p>Topic.js</p> <p>思考：</p> <p>​	功能少的子组件样式及数据，再单独去用文件夹去定义，就太过了，</p> <p>所以样式或者数据文件和home.js文件共用是可行的。</p> <div class="language- extra-class"><pre class="language-text"><code>- home
++ store
+++ reducer.js
+++ index.js 负责将reducer导出（优化路径，统一）

- src
-- store
--- reducer.js中引入即可

注意：
	immutable对象直接在dom中遍历时，要符合取值规范
{topicList.map((item, index) =&gt; {
    return (
      &lt;TopicItem key={index}&gt;
        &lt;img className='Topic-pic' src={item.get('imgUrl')} /&gt;
        {item.get('title')}
      &lt;/TopicItem&gt;
    )
})}	
</code></pre></div><h3 id="首页文章列表"><a href="#首页文章列表" aria-hidden="true" class="header-anchor">#</a> 首页文章列表</h3> <p>新建一个articleList 参数，去List.js中渲染</p> <div class="language- extra-class"><pre class="language-text"><code>articleList: [
    {
      id: 1,
      title: '用Flutter构建漂亮的UI界面 - 基础组件篇',
      imgUrl: 'https://upload',
      desc: '1. 前言 Flutter作为时下最流行的技术之一，凭借其出色的性能以及抹平多端的差异优势，早已引起大批技术爱好者的关注，甚至一些闲鱼，美团，腾...'
    }]
    
{articleList.map((item,index)=&gt;{
          return (
            &lt;ListItem key={item.get('id')}&gt;
              &lt;img className='pic' src={item.get('imgUrl')}/&gt;
              &lt;ListInfo&gt;
              &lt;h3 className='title'&gt;{item.get('title')}&lt;/h3&gt;
              &lt;p className='desc'&gt;{item.get('desc')}&lt;/p&gt;
              &lt;/ListInfo&gt;
            &lt;/ListItem&gt;
          )
        })}
</code></pre></div><p>警告提示：</p> <div class="language- extra-class"><pre class="language-text"><code>img elements must have an alt prop, either with meaningful text, or an empty string for decorative images  jsx-a11y/alt-text
</code></pre></div><p>原因：</p> <p>img 标签没有alt'属性</p> <p>解决方式：</p> <p>img 标签要加alt=''属性</p> <h3 id="首页推荐部分"><a href="#首页推荐部分" aria-hidden="true" class="header-anchor">#</a> 首页推荐部分</h3> <p>1、首页推荐</p> <p>RecommendWrapper</p> <p>2、推荐作者</p> <p>WriterWrapper</p> <h2 id="首页数据接口定义"><a href="#首页数据接口定义" aria-hidden="true" class="header-anchor">#</a> 首页数据接口定义</h2> <div class="language- extra-class"><pre class="language-text"><code>/api/home.json

返回体：
例：
{
    sucess: true,
    data: {
        topicList: [
    {
      id: 1,
      title: '程序员',
      imgUrl: '//upload.jianshu.io/collect'
    }],
    articleList: [
    {
      id: 1,
      title: '用Flutter构建漂亮的UI界面 - 基础组件篇',
      imgUrl: 'https://upload-w/360/h/240',
      desc: '1. 前言 F'
    }],
    recommendList: [
    {
      id: 1,
      imgUrl: 'https://cdn2.jianshu.io/a'
    }]
    }
}

home
- index.js
生命周期函数中调用：
componentDidMount () {
    const api = ' https://www.easy-mock.com/mock/5cac669516fea85e587f8deb/luodiye'
    axios.get(api + '/home/data').then((res) =&gt; {
      var result = res.data.data;
      var action = {
        type: 'change_home_data',
        articleList: result.articleList,
        recommendList: result.recommendList,
        topicList: result.topicList
      }
      this.props.changeHomeData(action);
      console.log(res);
    }).catch(() =&gt; {

    })
  }
}
通过react-redux中connect来操作即可
const mapDispathToProps = (dispatch) =&gt; ({
  changeHomeData (action) {
    dispatch(action)
  }
})

export default connect(null, mapDispathToProps)(Home);

reducer.js
import { fromJS } from 'immutable';
const defaultState = fromJS({
  topicList: [],
  articleList: [],
  recommendList: []
});

export default (state = defaultState, action) =&gt; {
  switch (action.type) {
    case 'change_home_data':
      console.log(action)
      // state.set('topicList',fromJS(action.topicList));
      return state.merge({
        topicList: fromJS(action.topicList),
        articleList: fromJS(action.articleList),
        recommendList: fromJS(action.recommendList)
      })
      break;
    default:
  }
  return state;
}

注意：
	merge
</code></pre></div><h3 id="代码拆分"><a href="#代码拆分" aria-hidden="true" class="header-anchor">#</a> 代码拆分</h3> <div class="language- extra-class"><pre class="language-text"><code>1、接口请求代码放在mapDispathToProps中
2、配置actionCreators.js和constans.js来管理action
</code></pre></div><h2 id="加载更多"><a href="#加载更多" aria-hidden="true" class="header-anchor">#</a> 加载更多</h2> <div class="language- extra-class"><pre class="language-text"><code>ajax请求：
case constants.ADD_LIST:
  console.log(action.list)
  return state.set('articleList', state.get('articleList').concat(action.list));
break;

分页：
reducer.js新增页码参数，然后每次加+即可
</code></pre></div><h2 id="返回顶部"><a href="#返回顶部" aria-hidden="true" class="header-anchor">#</a> 返回顶部</h2> <div class="language- extra-class"><pre class="language-text"><code>home
- index.js

创建按钮
export const BackTop = styled.div`
    position:fixed;
    right:100px;
    bottom:100px;
    font-size:12px;
    z-index:1000;
    width:60px;
    height:60px;
    line-height:60px;
    text-align:center;
    border:1px solid #ccc;
    cursor: pointer;
`;


&lt;BackTop onClick={this.handleScrollTop}&gt;回到顶部&lt;/BackTop&gt;
绑定事件即可
handleScrollTop () {
    window.scrollTo(0, 0)
  }
  
按钮回到顶部隐藏效果：
1、reducer新建showSroll值
showScroll: false

2、给页面绑定滚动事件
componentDidMount () {
    this.props.changeHomeData();
+   this.bindEvents();
  }
bindEvents () {
    window.addEventListener('scroll', this.props.changeScrollTopShow)
  }
  
3、当滚动距离大于100时显示滚动条
mapDispathToProps：
changeScrollTopShow (e) {
    if (document.documentElement.scrollTop &gt; 100) {
      dispatch(actionCreators.toggleTopShow(true));
    } else {
      dispatch(actionCreators.toggleTopShow(false));
    }
    console.log(document.documentElement.scrollTop)
  }
  
4、当组件从从页面卸载后，在wondow中绑定的方法一定要移除
componentWillUnmount () {
    window.removeEventListener('scroll', this.props.changeScrollTopShow);
  }
</code></pre></div><h3 id="代码优化"><a href="#代码优化" aria-hidden="true" class="header-anchor">#</a> 代码优化</h3> <p>reducer.js中switch语句比较多的时候，需要单独把处理逻辑提取出来会比较好</p> <div class="language- extra-class"><pre class="language-text"><code>即，
const changeHomeData = (state, action) =&gt; {
  return state.merge({
    topicList: fromJS(action.topicList),
    articleList: fromJS(action.articleList),
    recommendList: fromJS(action.recommendList)
  })
}


export default (state = defaultState, action) =&gt; {
  switch (action.type) {
    case constants.CHANGE_HOME_DATA:
      return changeHomeData(state, action);
    default:
  }
  return state;
}
</code></pre></div><h2 id="首页性能优化及路由跳转"><a href="#首页性能优化及路由跳转" aria-hidden="true" class="header-anchor">#</a> 首页性能优化及路由跳转</h2> <h3 id="性能优化"><a href="#性能优化" aria-hidden="true" class="header-anchor">#</a> 性能优化</h3> <p>1、当reducer中某个数据发生变化时，主组件的render主函数都会被重新执行，这样损耗性能。</p> <div class="language- extra-class"><pre class="language-text"><code>shouldComponentUpdate()
只有当与我这个组件相关的内容发生变化时，组件才重新被渲染；
但是每个组件中都这么写的话，未免太麻烦了，所以react内置了
一个PureComponent
表示一个纯组件


与Component区别：
底层实现了一个shouldComponentUpdate了，不需要再手写了

例如：
class Writer extends React.PureComponent {
  render () {
    return (
      &lt;WriterWrapper&gt;
        Writer
      &lt;/WriterWrapper&gt;
    )
  }
}

注意：
	1、必须是组件数据都是immutable数据才适合这个搭配
	2、否则可能会遇坑
</code></pre></div><h3 id="路由跳转"><a href="#路由跳转" aria-hidden="true" class="header-anchor">#</a> 路由跳转</h3> <p>首页跳转到详情页面</p> <div class="language- extra-class"><pre class="language-text"><code>1、进入详情页
例如：
&lt;a key={index} href='/detail'&gt;&lt;/a&gt;
能跳转但是还是问题：
	应该使用单页应用link跳转。单页应用，就是不管网页怎么变，都只会加载一个html页面。
	所以a标签跳转，不符合单页面应用跳转规则，跳转一次会重新加载一次html这是比较耗性能的。
改为：
&lt;Link key={index} to='/detail'&gt;&lt;/Link&gt;

2、点击简书logo返回首页
style.js中样式就不能用a标签写的，改成div
同时层包Link
&lt;Link to='/'&gt;&lt;/Link&gt;

注意：设置Link的组件必须包裹在Router中。
例：
&lt;Router&gt;
   &lt;Header&gt;&lt;/Header&gt;
   &lt;Route path='/' exact component={Home}&gt;&lt;/Route&gt;
   &lt;Route path='/detail' exact component={Detail}&gt;&lt;/Route&gt;
&lt;/Router&gt;
</code></pre></div><h2 id="详情页"><a href="#详情页" aria-hidden="true" class="header-anchor">#</a> 详情页</h2> <div class="language- extra-class"><pre class="language-text"><code>详情页：
export const DetailWrapper = styled.div`
    overflow:hidden;
    width:620px;
    margin:0 auto;
    padding-bottom:100px;
`;
1、标题
export const Header = styled.div`
    margin:50px 0 20px 0;
    font-size:34px;
    line-height:44px;
    color:#333;
    font-weight:bold;
`;

2、内容
export const Content = styled.div`
    color:#2f2f2f;
    img{
      width:100%;
    }
    p{
      margin:25px 0;
      color:#2f2f2f;
      font-size:16px;
      line-height:30px;
    }
`;
</code></pre></div><h3 id="数据管理"><a href="#数据管理" aria-hidden="true" class="header-anchor">#</a> 数据管理</h3> <div class="language- extra-class"><pre class="language-text"><code>按react-rudx一套流程书写
</code></pre></div><h3 id="页面路由参数传递"><a href="#页面路由参数传递" aria-hidden="true" class="header-anchor">#</a> 页面路由参数传递</h3> <div class="language- extra-class"><pre class="language-text"><code>1、动态路由
&lt;Link key={index} to={'/detail/' + item.get('id')}&gt;&lt;/Link&gt;
对应的路由匹配设置：
&lt;Route path='/detail/:id' exact component={Detail}&gt;&lt;/Route&gt;
获取id:
在详情页：this.props.match.params.id即可
2、方式二：
&lt;Link key={index} to={'/detail？id=' + item.get('id')}&gt;&lt;/Link&gt;
路由配置：
&lt;Route path='/detail' exact component={Detail}&gt;&lt;/Route&gt;
取值方式：
this.props.match.location.search // '?id=2'
需要自己处理字符串
</code></pre></div><h2 id="登录校验"><a href="#登录校验" aria-hidden="true" class="header-anchor">#</a> 登录校验</h2> <h3 id="布局"><a href="#布局" aria-hidden="true" class="header-anchor">#</a> 布局</h3> <div class="language- extra-class"><pre class="language-text"><code>+ login
++ index.js
&lt;LoginWrapper&gt;
    &lt;LoginBox&gt;
        &lt;Input placeholder=&quot;账号&quot; /&gt;
        &lt;Input placeholder=&quot;密码&quot; /&gt;
        &lt;Button&gt;登陆&lt;/Button&gt;
    &lt;/LoginBox&gt;
&lt;/LoginWrapper&gt;

++ style.js
import styled from 'styled-components';

export const LoginWrapper = styled.div`
	z-index: 0;
	position: absolute;
	left: 0;
	right: 0;
	bottom: 0;
	top: 56px;
	background: #eee;
`;

export const LoginBox = styled.div`
	width: 400px;
	height: 180px;
	margin: 100px auto;
	padding-top: 20px;
	background: #fff;
	box-shadow: 0 0 8px rgba(0,0,0,.1);
`;

export const Input = styled.input`
	display: block;
	width: 200px;
	height: 30px;
	line-height: 30px;
	padding: 0 10px;
	margin: 10px auto;
	color: #777;
`;

export const Button = styled.div`
	width: 220px;
	height: 30px;
	line-height: 30px;
	color: #fff;
	background: #3194d0;
	border-radius: 15px;
	margin: 10px auto;
	text-align: center;
`;
</code></pre></div><h3 id="功能实现"><a href="#功能实现" aria-hidden="true" class="header-anchor">#</a> 功能实现</h3> <div class="language- extra-class"><pre class="language-text"><code>+ store
++ actionCreators.js
++ constants.js
++ index.js
++ reducer.js

1、首页如果登录了隐藏登录，没有登陆则显示登录按钮
2、登录取值
3、登陆成功之后去首页
import { Redirect } from 'react-router-dom';
重定向
- login
- index.js
通过登录状态来重定向到首页
例2：
} else {
      return &lt;Redirect to='/' /&gt;;
}
</code></pre></div><h3 id="登录鉴权及代码优化"><a href="#登录鉴权及代码优化" aria-hidden="true" class="header-anchor">#</a> 登录鉴权及代码优化</h3> <p>​	写文章页面只有用户登录了才能访问</p> <div class="language- extra-class"><pre class="language-text"><code>const { loginStatus } = this.props;
    if (loginStatus) {
      return (
        &lt;div&gt;写文章&lt;/div&gt;
      )
    } else {
      return &lt;Redirect to='/login' /&gt;;
    }
</code></pre></div><p>代码优化：</p> <div class="language- extra-class"><pre class="language-text"><code>1、回车间隔，分号；
2、reducer.js中case内容太多，可以拆分出来；
3、异步请求时，请求失败的情况也要处理.catch(()=&gt;{});
</code></pre></div><h2 id="异步组件及路由使用"><a href="#异步组件及路由使用" aria-hidden="true" class="header-anchor">#</a> 异步组件及路由使用</h2> <p>​	打开控制台，network选择js可以发现，路由跳转等才做，都只加载了一个bundle.js说明，页面所有处理都在这一个文件里面。</p> <p>​	但如果只是在首页，而把详情页的js也包含了，那也对性能有一定的损耗。</p> <p>​	最好是访问首页只加载首页代码，访问详情页加载详情页代码...</p> <p>基于以上需求，所以就要使用到“异步组件这个概念了”</p> <p><a href="https://github.com/jamiebuilds/react-loadable" target="_blank" rel="noopener noreferrer">react-loadble<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- extra-class"><pre class="language-text"><code>npm i react-loadable -S

例如详情页：
- detail
++ loadable.js
import React from 'react';
import Loadable from 'react-loadable';


const LoadableComponent = Loadable({
  // 指异步加载一个新组件
  loader: () =&gt; import('./'),
  // 指通过函数显示一个临时加载样式组件
  loading () {
    return &lt;div&gt;正在加载...&lt;/div&gt;
  },
});

export default () =&gt; &lt;LoadableComponent /&gt;;

- src
-- App.js
import Detail from './page/detail';
改成：
import Detail from './page/detail/loadable';

进入详情页发现报错：
TypeError: Cannot read property 'params' of undefined
console.log(this.props.match.params.id)

原因：
通过loadable组件进入的detail页面，不是路由直接对应的组件
所以loadable能获取到路由数据，但是loadable下的组件就不能获取到。

解决方法：
- detail
-- index.js
import { withRouter } from 'react-router-dom';

export default connect(mapStateToProps, mapDispathToProps)(withRouter(Detail));

这样就能获取参数了

此时bundle.js中是没有详情页代码的
点击进入详情页会加载一个
1.chunck.js
</code></pre></div><h2 id="项目上线"><a href="#项目上线" aria-hidden="true" class="header-anchor">#</a> 项目上线</h2> <p>后端上线流程</p> <div class="language- extra-class"><pre class="language-text"><code>1、php
先安装：XAMPP
帮助本地起一个服务器：

</code></pre></div><h2 id="react版本升级说明"><a href="#react版本升级说明" aria-hidden="true" class="header-anchor">#</a> React版本升级说明</h2></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/gangking/myBlog/edit/master/docs/react/03.md" target="_blank" rel="noopener noreferrer">编辑文档</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2019-8-9 20:04:32</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/myBlog/react/02.html" class="prev">
          React慕课笔记
        </a></span> <span class="next"><a href="/myBlog/react/04.html">
          项目心得
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/myBlog/assets/js/app.9a205e1a.js" defer></script><script src="/myBlog/assets/js/2.c03f67b8.js" defer></script><script src="/myBlog/assets/js/24.b5e770f4.js" defer></script>
  </body>
</html>
